/*
 * Copyright 2024 NXP
 * All rights reserved.
 *
 * SPDX-License-Identifier: BSD-3-Clause
 */

#include "els_pkc_fips_ecdh.h"

/*******************************************************************************
 * Definitions
 ******************************************************************************/
#define WEIER256_BIT_LENGTH (256U)
#define WEIER384_BIT_LENGTH (384U)
#define WEIER521_BIT_LENGTH (521U)

/*******************************************************************************
 * Prototypes
 ******************************************************************************/

/*******************************************************************************
 * Variables
 ******************************************************************************/
/* Domain parameters for ECC-Weier */
static const uint8_t s_BN_P256_P[WEIER256_BIT_LENGTH / 8U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0x00U, 0x00U, 0x00U, 0x01U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U,
    0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU};

static const uint8_t s_BN_P256_A[WEIER256_BIT_LENGTH / 8U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0x00U, 0x00U, 0x00U, 0x01U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U,
    0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFCU};

static const uint8_t s_BN_P256_B[WEIER256_BIT_LENGTH / 8U] = {
    0x5AU, 0xC6U, 0x35U, 0xD8U, 0xAAU, 0x3AU, 0x93U, 0xE7U, 0xB3U, 0xEBU, 0xBDU, 0x55U, 0x76U, 0x98U, 0x86U, 0xBCU,
    0x65U, 0x1DU, 0x06U, 0xB0U, 0xCCU, 0x53U, 0xB0U, 0xF6U, 0x3BU, 0xCEU, 0x3CU, 0x3EU, 0x27U, 0xD2U, 0x60U, 0x4BU};

static const uint8_t s_BN_P256_G[2U * WEIER256_BIT_LENGTH / 8U] = {
    0x6BU, 0x17U, 0xD1U, 0xF2U, 0xE1U, 0x2CU, 0x42U, 0x47U, 0xF8U, 0xBCU, 0xE6U, 0xE5U, 0x63U, 0xA4U, 0x40U, 0xF2U,
    0x77U, 0x03U, 0x7DU, 0x81U, 0x2DU, 0xEBU, 0x33U, 0xA0U, 0xF4U, 0xA1U, 0x39U, 0x45U, 0xD8U, 0x98U, 0xC2U, 0x96U,
    0x4FU, 0xE3U, 0x42U, 0xE2U, 0xFEU, 0x1AU, 0x7FU, 0x9BU, 0x8EU, 0xE7U, 0xEBU, 0x4AU, 0x7CU, 0x0FU, 0x9EU, 0x16U,
    0x2BU, 0xCEU, 0x33U, 0x57U, 0x6BU, 0x31U, 0x5EU, 0xCEU, 0xCBU, 0xB6U, 0x40U, 0x68U, 0x37U, 0xBFU, 0x51U, 0xF5U};

static const uint8_t s_BN_P256_N[WEIER256_BIT_LENGTH / 8U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xBCU, 0xE6U, 0xFAU, 0xADU, 0xA7U, 0x17U, 0x9EU, 0x84U, 0xF3U, 0xB9U, 0xCAU, 0xC2U, 0xFCU, 0x63U, 0x25U, 0x51U};

static const uint8_t s_BN_P384_P[48U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFEU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFFU};

static const uint8_t s_BN_P384_A[48U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFEU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFCU};

static const uint8_t s_BN_P384_B[48U] = {
    0xB3U, 0x31U, 0x2FU, 0xA7U, 0xE2U, 0x3EU, 0xE7U, 0xE4U, 0x98U, 0x8EU, 0x05U, 0x6BU, 0xE3U, 0xF8U, 0x2DU, 0x19U,
    0x18U, 0x1DU, 0x9CU, 0x6EU, 0xFEU, 0x81U, 0x41U, 0x12U, 0x03U, 0x14U, 0x08U, 0x8FU, 0x50U, 0x13U, 0x87U, 0x5AU,
    0xC6U, 0x56U, 0x39U, 0x8DU, 0x8AU, 0x2EU, 0xD1U, 0x9DU, 0x2AU, 0x85U, 0xC8U, 0xEDU, 0xD3U, 0xECU, 0x2AU, 0xEFU};

static const uint8_t s_BN_P384_G[96U] = {
    0xAAU, 0x87U, 0xCAU, 0x22U, 0xBEU, 0x8BU, 0x05U, 0x37U, 0x8EU, 0xB1U, 0xC7U, 0x1EU, 0xF3U, 0x20U, 0xADU, 0x74U,
    0x6EU, 0x1DU, 0x3BU, 0x62U, 0x8BU, 0xA7U, 0x9BU, 0x98U, 0x59U, 0xF7U, 0x41U, 0xE0U, 0x82U, 0x54U, 0x2AU, 0x38U,
    0x55U, 0x02U, 0xF2U, 0x5DU, 0xBFU, 0x55U, 0x29U, 0x6CU, 0x3AU, 0x54U, 0x5EU, 0x38U, 0x72U, 0x76U, 0x0AU, 0xB7U,
    0x36U, 0x17U, 0xDEU, 0x4AU, 0x96U, 0x26U, 0x2CU, 0x6FU, 0x5DU, 0x9EU, 0x98U, 0xBFU, 0x92U, 0x92U, 0xDCU, 0x29U,
    0xF8U, 0xF4U, 0x1DU, 0xBDU, 0x28U, 0x9AU, 0x14U, 0x7CU, 0xE9U, 0xDAU, 0x31U, 0x13U, 0xB5U, 0xF0U, 0xB8U, 0xC0U,
    0x0AU, 0x60U, 0xB1U, 0xCEU, 0x1DU, 0x7EU, 0x81U, 0x9DU, 0x7AU, 0x43U, 0x1DU, 0x7CU, 0x90U, 0xEAU, 0x0EU, 0x5FU};

static const uint8_t s_BN_P384_N[48U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xC7U, 0x63U, 0x4DU, 0x81U, 0xF4U, 0x37U, 0x2DU, 0xDFU,
    0x58U, 0x1AU, 0x0DU, 0xB2U, 0x48U, 0xB0U, 0xA7U, 0x7AU, 0xECU, 0xECU, 0x19U, 0x6AU, 0xCCU, 0xC5U, 0x29U, 0x73U};

static const uint8_t s_BN_P521_P[66U] = {0x01U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                         0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                         0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                         0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                         0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                         0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU};

static const uint8_t s_BN_P521_A[66U] = {0x01U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                         0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                         0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                         0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                         0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                         0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFCU};

static const uint8_t s_BN_P521_B[66U] = {0x00U, 0x51U, 0x95U, 0x3EU, 0xB9U, 0x61U, 0x8EU, 0x1CU, 0x9AU, 0x1FU, 0x92U,
                                         0x9AU, 0x21U, 0xA0U, 0xB6U, 0x85U, 0x40U, 0xEEU, 0xA2U, 0xDAU, 0x72U, 0x5BU,
                                         0x99U, 0xB3U, 0x15U, 0xF3U, 0xB8U, 0xB4U, 0x89U, 0x91U, 0x8EU, 0xF1U, 0x09U,
                                         0xE1U, 0x56U, 0x19U, 0x39U, 0x51U, 0xECU, 0x7EU, 0x93U, 0x7BU, 0x16U, 0x52U,
                                         0xC0U, 0xBDU, 0x3BU, 0xB1U, 0xBFU, 0x07U, 0x35U, 0x73U, 0xDFU, 0x88U, 0x3DU,
                                         0x2CU, 0x34U, 0xF1U, 0xEFU, 0x45U, 0x1FU, 0xD4U, 0x6BU, 0x50U, 0x3FU, 0x00U};

static const uint8_t s_BN_P521_G[2U * 66U] = {
    0x00U, 0xC6U, 0x85U, 0x8EU, 0x06U, 0xB7U, 0x04U, 0x04U, 0xE9U, 0xCDU, 0x9EU, 0x3EU, 0xCBU, 0x66U, 0x23U,
    0x95U, 0xB4U, 0x42U, 0x9CU, 0x64U, 0x81U, 0x39U, 0x05U, 0x3FU, 0xB5U, 0x21U, 0xF8U, 0x28U, 0xAFU, 0x60U,
    0x6BU, 0x4DU, 0x3DU, 0xBAU, 0xA1U, 0x4BU, 0x5EU, 0x77U, 0xEFU, 0xE7U, 0x59U, 0x28U, 0xFEU, 0x1DU, 0xC1U,
    0x27U, 0xA2U, 0xFFU, 0xA8U, 0xDEU, 0x33U, 0x48U, 0xB3U, 0xC1U, 0x85U, 0x6AU, 0x42U, 0x9BU, 0xF9U, 0x7EU,
    0x7EU, 0x31U, 0xC2U, 0xE5U, 0xBDU, 0x66U, 0x01U, 0x18U, 0x39U, 0x29U, 0x6AU, 0x78U, 0x9AU, 0x3BU, 0xC0U,
    0x04U, 0x5CU, 0x8AU, 0x5FU, 0xB4U, 0x2CU, 0x7DU, 0x1BU, 0xD9U, 0x98U, 0xF5U, 0x44U, 0x49U, 0x57U, 0x9BU,
    0x44U, 0x68U, 0x17U, 0xAFU, 0xBDU, 0x17U, 0x27U, 0x3EU, 0x66U, 0x2CU, 0x97U, 0xEEU, 0x72U, 0x99U, 0x5EU,
    0xF4U, 0x26U, 0x40U, 0xC5U, 0x50U, 0xB9U, 0x01U, 0x3FU, 0xADU, 0x07U, 0x61U, 0x35U, 0x3CU, 0x70U, 0x86U,
    0xA2U, 0x72U, 0xC2U, 0x40U, 0x88U, 0xBEU, 0x94U, 0x76U, 0x9FU, 0xD1U, 0x66U, 0x50U};

static const uint8_t s_BN_P521_N[66U] = {0x01U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                         0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                         0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                         0xFAU, 0x51U, 0x86U, 0x87U, 0x83U, 0xBFU, 0x2FU, 0x96U, 0x6BU, 0x7FU, 0xCCU,
                                         0x01U, 0x48U, 0xF7U, 0x09U, 0xA5U, 0xD0U, 0x3BU, 0xB5U, 0xC9U, 0xB8U, 0x89U,
                                         0x9CU, 0x47U, 0xAEU, 0xBBU, 0x6FU, 0xB7U, 0x1EU, 0x91U, 0x38U, 0x64U, 0x09U};

/* Private key input for ECC-Weier */
static const uint8_t s_PrivateKeyInputWeier256Bob[32U] = {
    0xE9U, 0x46U, 0xFFU, 0x12U, 0xFFU, 0xB2U, 0xE7U, 0xBAU, 0x2CU, 0x5DU, 0x3AU, 0xAFU, 0x7DU, 0x9AU, 0xEEU, 0xE2U,
    0x00U, 0x59U, 0x7AU, 0xABU, 0x20U, 0xCAU, 0xB0U, 0xF9U, 0x6BU, 0xD4U, 0x84U, 0x75U, 0x3DU, 0x78U, 0xFEU, 0xF4U};

static const uint8_t s_PrivateKeyInputWeier384Bob[48U] = {
    0x8EU, 0x49U, 0xBFU, 0x1CU, 0x5DU, 0x9CU, 0xBEU, 0x73U, 0xD5U, 0xD3U, 0xDCU, 0xD7U, 0xBBU, 0x57U, 0x6AU, 0x2BU,
    0xDEU, 0x17U, 0xB1U, 0xAAU, 0xA7U, 0xCCU, 0x31U, 0xD0U, 0x24U, 0x10U, 0xB0U, 0xE6U, 0x9FU, 0xF7U, 0x42U, 0x4BU,
    0xA6U, 0x58U, 0x87U, 0x41U, 0x6AU, 0x04U, 0x14U, 0x43U, 0x4CU, 0x25U, 0x5CU, 0xECU, 0x9DU, 0x84U, 0x36U, 0x88U};

static const uint8_t s_PrivateKeyInputWeier521Bob[66U] = {
    0x00U, 0xA8U, 0x14U, 0x1AU, 0xE2U, 0xF5U, 0x5FU, 0xFCU, 0x6EU, 0x4AU, 0x39U, 0xF2U, 0x0FU, 0x3DU,
    0x53U, 0x47U, 0x19U, 0xB0U, 0x6BU, 0x32U, 0xC7U, 0xBDU, 0xEAU, 0x46U, 0x40U, 0x58U, 0xE2U, 0xC6U,
    0x73U, 0xD4U, 0xE2U, 0x35U, 0x73U, 0x8FU, 0x0FU, 0x49U, 0x08U, 0x2AU, 0x8FU, 0xE7U, 0xAAU, 0x47U,
    0x1DU, 0x2AU, 0x73U, 0x61U, 0xCAU, 0x2CU, 0xF7U, 0x60U, 0x6EU, 0x85U, 0xDBU, 0xD7U, 0x03U, 0xBEU,
    0xA6U, 0x3FU, 0xB3U, 0xCDU, 0x8CU, 0x78U, 0x72U, 0xA9U, 0x4BU, 0x20U};

/* Public key input for ECC-Weier */
static const uint8_t s_PublicKeyInputWeier256Bob[64U] = {
    0x52U, 0x03U, 0x46U, 0xA7U, 0x4AU, 0x71U, 0xE0U, 0x4DU, 0x39U, 0xFEU, 0x4BU, 0x20U, 0x1BU, 0xF7U, 0x4CU, 0x92U,
    0xB6U, 0xBEU, 0x9FU, 0x88U, 0x11U, 0x1EU, 0x7CU, 0x31U, 0x63U, 0x13U, 0xB3U, 0xFCU, 0x94U, 0x85U, 0xDAU, 0xD9U,
    0x70U, 0x7AU, 0xBDU, 0x51U, 0x8EU, 0x51U, 0xC2U, 0xD6U, 0x56U, 0x54U, 0xC4U, 0xD9U, 0x86U, 0xE7U, 0x76U, 0x9FU,
    0x4EU, 0xA1U, 0xD9U, 0x37U, 0x39U, 0xF7U, 0xC3U, 0xABU, 0x73U, 0x89U, 0xBDU, 0x30U, 0x03U, 0x17U, 0x9BU, 0xD9U};

static const uint8_t s_PublicKeyInputWeier384Bob[96U] = {
    0xF8U, 0xA0U, 0x2DU, 0xAFU, 0xF4U, 0x6EU, 0x02U, 0xD2U, 0x6FU, 0xC8U, 0x9EU, 0x9CU, 0x04U, 0x0BU, 0x89U, 0x93U,
    0x69U, 0x5AU, 0xD1U, 0x60U, 0xDBU, 0x43U, 0x3DU, 0x09U, 0x86U, 0xAAU, 0x05U, 0xAAU, 0xADU, 0x54U, 0x6FU, 0x97U,
    0x86U, 0x94U, 0x60U, 0x1AU, 0xEAU, 0x80U, 0x85U, 0x98U, 0x9EU, 0x9DU, 0x6AU, 0x58U, 0x04U, 0xC5U, 0x66U, 0x49U,
    0x9AU, 0xAEU, 0x74U, 0x93U, 0x23U, 0x23U, 0x4FU, 0x63U, 0xCBU, 0x20U, 0x67U, 0x38U, 0x48U, 0x65U, 0x97U, 0x96U,
    0x1CU, 0x1DU, 0xB0U, 0xA4U, 0x1DU, 0x40U, 0x52U, 0x43U, 0xFAU, 0x08U, 0xFAU, 0x41U, 0xB8U, 0xA6U, 0x90U, 0x8EU,
    0x04U, 0x6EU, 0x1AU, 0x48U, 0x74U, 0x90U, 0xC2U, 0x08U, 0x3BU, 0x5EU, 0x91U, 0x25U, 0xBCU, 0xADU, 0xD4U, 0x54U};

static const uint8_t s_PublicKeyInputWeier521Bob[132U] = {
    0x00U, 0x4BU, 0x29U, 0xF5U, 0xEFU, 0x68U, 0xBBU, 0x53U, 0x47U, 0xA5U, 0x4AU, 0x76U, 0x6AU, 0x09U, 0x80U,
    0xD6U, 0x1FU, 0x45U, 0xA1U, 0x90U, 0xD8U, 0xBBU, 0x4EU, 0xFDU, 0x88U, 0x90U, 0x5FU, 0xA6U, 0xABU, 0x6AU,
    0x6DU, 0x6BU, 0x5EU, 0xFAU, 0x5BU, 0x3EU, 0xB4U, 0xBCU, 0x4CU, 0xB4U, 0x98U, 0x6BU, 0xF0U, 0xB5U, 0x99U,
    0xACU, 0xB1U, 0xAAU, 0xD8U, 0x62U, 0xADU, 0xE0U, 0xCAU, 0x7AU, 0x22U, 0x4AU, 0xE0U, 0xC5U, 0xAEU, 0x6DU,
    0x6EU, 0x9EU, 0x97U, 0x88U, 0xDDU, 0xA0U, 0x01U, 0x01U, 0x08U, 0x21U, 0x53U, 0x9BU, 0xDAU, 0x45U, 0x0FU,
    0xCBU, 0x07U, 0x93U, 0x8EU, 0xFCU, 0x8EU, 0xE5U, 0x56U, 0xF8U, 0x8AU, 0xE0U, 0xC8U, 0x06U, 0xA8U, 0x7CU,
    0xD2U, 0x1AU, 0x1EU, 0x82U, 0x8EU, 0x3AU, 0xECU, 0x00U, 0x5EU, 0x0DU, 0x90U, 0x5FU, 0x13U, 0xF5U, 0x50U,
    0xE1U, 0xA1U, 0x95U, 0x6DU, 0x76U, 0x80U, 0xEEU, 0x9AU, 0xC5U, 0x88U, 0xBEU, 0x42U, 0x85U, 0x5CU, 0x15U,
    0xDDU, 0xCBU, 0x97U, 0xA9U, 0xFAU, 0x1BU, 0x24U, 0x91U, 0x98U, 0xA5U, 0x49U, 0x8EU};

/* Private key input for ECC-Weier */
static const uint8_t s_PrivateKeyInputWeier256Alice[32U] = {
    0x10U, 0x69U, 0x26U, 0x12U, 0xAEU, 0xDEU, 0x15U, 0xC2U, 0xC5U, 0x82U, 0x41U, 0x5BU, 0xB8U, 0xDEU, 0xF5U, 0xABU,
    0x6CU, 0xFDU, 0x6CU, 0xD5U, 0x05U, 0x27U, 0x70U, 0xACU, 0xF2U, 0xFAU, 0x71U, 0x3DU, 0x01U, 0xC1U, 0x9DU, 0x4EU};

static const uint8_t s_PrivateKeyInputWeier384Alice[48U] = {
    0xE5U, 0x86U, 0xEEU, 0x87U, 0xCFU, 0x1DU, 0x30U, 0xB3U, 0x5EU, 0xDEU, 0x97U, 0x76U, 0xA0U, 0x5BU, 0x37U, 0xDEU,
    0x57U, 0x4AU, 0x35U, 0x65U, 0x70U, 0x24U, 0x9CU, 0xB0U, 0xBCU, 0x8DU, 0x86U, 0xF8U, 0x90U, 0x87U, 0x9FU, 0xB7U,
    0x7CU, 0x2DU, 0x29U, 0xFEU, 0x08U, 0x30U, 0xA2U, 0x21U, 0x0FU, 0xD0U, 0xF6U, 0x3FU, 0x4BU, 0xE3U, 0xF4U, 0x40U};

static const uint8_t s_PrivateKeyInputWeier521Alice[66U] = {
    0x00U, 0xE3U, 0xCCU, 0xB7U, 0xDCU, 0x9BU, 0x83U, 0xBFU, 0x33U, 0x1AU, 0x87U, 0x99U, 0x01U, 0xECU,
    0xD0U, 0x20U, 0x09U, 0x7AU, 0x87U, 0x57U, 0x7FU, 0x28U, 0x28U, 0x5AU, 0xE6U, 0x75U, 0x61U, 0xC7U,
    0x09U, 0x53U, 0xDEU, 0x26U, 0x07U, 0x56U, 0xB6U, 0xEEU, 0x1AU, 0x4CU, 0x1FU, 0x1EU, 0x33U, 0xFBU,
    0x69U, 0x5EU, 0xCAU, 0xE4U, 0x37U, 0x68U, 0x77U, 0x02U, 0xF0U, 0xC4U, 0x1BU, 0x71U, 0x1DU, 0xA2U,
    0xFAU, 0x26U, 0x95U, 0xC7U, 0xD8U, 0xFFU, 0x1AU, 0x37U, 0x70U, 0x99U};

/* Public key input for ECC-Weier */
static const uint8_t s_PublicKeyInputWeier256Alice[64U] = {
    0x27U, 0x78U, 0x9EU, 0x21U, 0x7DU, 0x91U, 0x50U, 0x1AU, 0xBEU, 0xD0U, 0x42U, 0xACU, 0x2AU, 0xDBU, 0xE6U, 0xAFU,
    0x42U, 0x94U, 0xE3U, 0x4CU, 0x6BU, 0x9BU, 0xF0U, 0xCAU, 0x8CU, 0xE0U, 0xE4U, 0xA7U, 0xDEU, 0xBCU, 0xC4U, 0xD3U,
    0xF2U, 0x63U, 0x7AU, 0xE2U, 0x05U, 0x23U, 0x21U, 0xCCU, 0xECU, 0xCAU, 0x60U, 0x5EU, 0x40U, 0xF1U, 0x48U, 0x4AU,
    0x7EU, 0x38U, 0x9DU, 0x86U, 0x21U, 0xA5U, 0xFCU, 0x94U, 0xA7U, 0x0CU, 0xB5U, 0xF2U, 0xABU, 0xA1U, 0x6BU, 0x5DU};

static const uint8_t s_PublicKeyInputWeier384Alice[96U] = {
    0x10U, 0xF9U, 0xF8U, 0xBEU, 0x95U, 0x95U, 0x0EU, 0xF7U, 0x07U, 0x1EU, 0x84U, 0xC8U, 0x06U, 0xB5U, 0x19U, 0x2EU,
    0xA1U, 0x04U, 0x50U, 0x4FU, 0x5CU, 0xADU, 0x82U, 0x2DU, 0x85U, 0x7AU, 0x8EU, 0x9CU, 0x97U, 0x5CU, 0xF9U, 0x12U,
    0xBBU, 0x35U, 0x17U, 0x13U, 0xDEU, 0x77U, 0x64U, 0xEFU, 0xE7U, 0x80U, 0xADU, 0x6AU, 0x52U, 0x1DU, 0xA9U, 0x93U,
    0x39U, 0xC7U, 0x7DU, 0x76U, 0xFAU, 0x6FU, 0xD5U, 0x4FU, 0x8AU, 0x82U, 0x66U, 0xFAU, 0x14U, 0x35U, 0xA5U, 0x83U,
    0x06U, 0xFAU, 0xF5U, 0x23U, 0xECU, 0x8CU, 0x71U, 0x3FU, 0x7AU, 0xDCU, 0x7EU, 0x86U, 0x03U, 0xBFU, 0xE1U, 0x57U,
    0x8DU, 0x49U, 0x2DU, 0xDBU, 0x49U, 0xD0U, 0xCDU, 0xB8U, 0x51U, 0x07U, 0xD6U, 0xE2U, 0x02U, 0x0FU, 0x7AU, 0x94U};

static const uint8_t s_PublicKeyInputWeier521Alice[132U] = {
    0x00U, 0x4DU, 0xE9U, 0xC6U, 0xAFU, 0x37U, 0xD4U, 0x53U, 0x79U, 0xD8U, 0xACU, 0xE3U, 0xF7U, 0xD0U, 0x73U,
    0xC7U, 0xFBU, 0x7AU, 0xB1U, 0x71U, 0x2FU, 0xA9U, 0xC7U, 0x47U, 0x0CU, 0x06U, 0xD8U, 0xF8U, 0x52U, 0x9DU,
    0x53U, 0xF8U, 0x05U, 0xDFU, 0x43U, 0x8BU, 0x77U, 0x80U, 0x21U, 0x5AU, 0x23U, 0x08U, 0xCDU, 0xD7U, 0x8EU,
    0x06U, 0xB8U, 0x0DU, 0xC3U, 0x2CU, 0xA8U, 0x00U, 0x44U, 0x72U, 0xC2U, 0xC5U, 0x57U, 0xD8U, 0x83U, 0xACU,
    0x95U, 0x1DU, 0x41U, 0xD3U, 0x65U, 0xF4U, 0x00U, 0x9FU, 0xBAU, 0x60U, 0x1FU, 0x9EU, 0xADU, 0x2CU, 0x2BU,
    0xC0U, 0x0EU, 0xC0U, 0xD9U, 0x06U, 0xEEU, 0x1BU, 0xABU, 0xB4U, 0x06U, 0x89U, 0x30U, 0xE0U, 0x05U, 0x22U,
    0xD0U, 0x00U, 0x18U, 0x78U, 0xC4U, 0x8DU, 0x60U, 0xB2U, 0x9FU, 0x11U, 0xF9U, 0x5BU, 0x9DU, 0x19U, 0x02U,
    0x2FU, 0x3FU, 0xA5U, 0xB1U, 0xFDU, 0xB9U, 0x4BU, 0xA2U, 0xCFU, 0x1FU, 0x3BU, 0xC2U, 0x84U, 0xAEU, 0x8EU,
    0x4AU, 0xC7U, 0x69U, 0x8EU, 0x29U, 0x8CU, 0x40U, 0xF4U, 0xC1U, 0xDDU, 0x0CU, 0xA5U};

/* d_A * Q_B KAT */
static const uint8_t s_AlicePointMult256[64U] = {
    0x8BU, 0x5EU, 0x66U, 0x67U, 0xE4U, 0x75U, 0xB3U, 0xE8U, 0xBCU, 0x0BU, 0xCEU, 0x98U, 0xA8U, 0x99U, 0xCFU, 0x82U,
    0xDCU, 0x70U, 0xE8U, 0x78U, 0xC3U, 0x8AU, 0xACU, 0x2EU, 0x85U, 0xC2U, 0xEAU, 0x4CU, 0x59U, 0x8BU, 0x9FU, 0xA1U,
    0x3DU, 0x17U, 0xCFU, 0x4FU, 0xD7U, 0x33U, 0x16U, 0xCBU, 0xABU, 0x9EU, 0x61U, 0x4AU, 0xFDU, 0x90U, 0x9FU, 0x97U,
    0xADU, 0x69U, 0x83U, 0xE4U, 0xD0U, 0xBDU, 0x97U, 0x48U, 0x1DU, 0xAFU, 0x3DU, 0x52U, 0x3CU, 0x4AU, 0x4DU, 0x58U};

static const uint8_t s_AlicePointMult384[96U] = {
    0xADU, 0x33U, 0x08U, 0x83U, 0x7EU, 0x17U, 0xAAU, 0x00U, 0xC1U, 0x1FU, 0x10U, 0xBDU, 0x8CU, 0xC4U, 0x51U, 0xAFU,
    0x92U, 0x46U, 0x01U, 0xBDU, 0xA3U, 0xB7U, 0x1DU, 0x62U, 0xE2U, 0xF6U, 0x64U, 0x1DU, 0x09U, 0x1BU, 0xADU, 0x3CU,
    0xA4U, 0x2AU, 0x64U, 0x1BU, 0x55U, 0x4EU, 0xDFU, 0x8FU, 0x1CU, 0x39U, 0x93U, 0xACU, 0xEDU, 0x1CU, 0xE3U, 0x53U,
    0xDEU, 0xDBU, 0x38U, 0x99U, 0x68U, 0x7DU, 0xBCU, 0xAEU, 0x93U, 0xC4U, 0x54U, 0xDEU, 0x76U, 0x2AU, 0x2AU, 0xF2U,
    0xC2U, 0x48U, 0x14U, 0xFEU, 0x8DU, 0xE8U, 0xAAU, 0x52U, 0x84U, 0xD1U, 0x8DU, 0x21U, 0x32U, 0x7EU, 0xD1U, 0x77U,
    0xD0U, 0x91U, 0xC2U, 0x64U, 0x4FU, 0xC1U, 0x78U, 0xDAU, 0x2CU, 0x37U, 0xBCU, 0x49U, 0x9AU, 0x12U, 0xD6U, 0xD2U};

static const uint8_t s_AlicePointMult521[132U] = {
    0x01U, 0x95U, 0xA9U, 0xC1U, 0x23U, 0x47U, 0x1EU, 0x42U, 0x00U, 0x88U, 0x96U, 0x39U, 0x3CU, 0xD8U, 0x17U,
    0x32U, 0x4DU, 0xEFU, 0xCEU, 0x18U, 0xF1U, 0xB0U, 0x00U, 0x17U, 0xF4U, 0x54U, 0x4BU, 0xC3U, 0x0FU, 0xAEU,
    0xE2U, 0xA8U, 0x7FU, 0x7DU, 0x23U, 0x2BU, 0xE4U, 0x6DU, 0x97U, 0xECU, 0xFEU, 0x94U, 0x20U, 0x89U, 0xA3U,
    0x42U, 0x8BU, 0x3CU, 0xB0U, 0x26U, 0xC6U, 0xA0U, 0x70U, 0x5BU, 0x3FU, 0x7FU, 0x50U, 0x34U, 0x31U, 0xD9U,
    0x86U, 0x1EU, 0x3CU, 0x77U, 0x3AU, 0x0DU, 0x01U, 0x53U, 0xF3U, 0x67U, 0x5AU, 0xF8U, 0x12U, 0x3BU, 0xCEU,
    0x38U, 0x35U, 0x5BU, 0xF7U, 0x2DU, 0x0DU, 0xFBU, 0x54U, 0x51U, 0xF9U, 0x6CU, 0xF1U, 0x6DU, 0x49U, 0x78U,
    0x81U, 0xAEU, 0xE5U, 0xE6U, 0x0FU, 0x6FU, 0x36U, 0x2BU, 0xECU, 0x69U, 0x8CU, 0x9CU, 0x4EU, 0x85U, 0x40U,
    0x7DU, 0xD1U, 0x45U, 0xE9U, 0xF5U, 0x98U, 0x7BU, 0xF8U, 0x5EU, 0x03U, 0xB9U, 0x83U, 0xD7U, 0xCAU, 0xE5U,
    0x46U, 0x42U, 0x84U, 0x2BU, 0x5DU, 0x48U, 0xFDU, 0x90U, 0x78U, 0xBAU, 0x19U, 0x7CU};

/* Shared Secret KATs */
static const uint8_t s_SharedSecretKat256[64U] = {
    0xA1U, 0xF8U, 0x68U, 0x2DU, 0xCEU, 0x73U, 0x67U, 0x1CU, 0x0BU, 0x72U, 0xC9U, 0xD3U, 0xD6U, 0x90U, 0xA3U, 0x21U,
    0x47U, 0x29U, 0xCDU, 0xDFU, 0x64U, 0x8FU, 0x58U, 0x7BU, 0x35U, 0xA9U, 0xFAU, 0x46U, 0x8EU, 0xFCU, 0x79U, 0xA3U,
    0x1FU, 0x63U, 0x57U, 0xC7U, 0xC6U, 0xAFU, 0xB0U, 0xA6U, 0xD8U, 0x58U, 0x6FU, 0x68U, 0x6DU, 0xD0U, 0x3FU, 0x99U,
    0xABU, 0x21U, 0x2CU, 0x0AU, 0xAEU, 0xCBU, 0xDDU, 0x93U, 0x3DU, 0xAFU, 0x15U, 0xD2U, 0x30U, 0x5AU, 0x5BU, 0x8DU};

static const uint8_t s_SharedSecretKat384[96U] = {
    0xF8U, 0xA0U, 0x2DU, 0xAFU, 0xF4U, 0x6EU, 0x02U, 0xD2U, 0x6FU, 0xC8U, 0x9EU, 0x9CU, 0x04U, 0x0BU, 0x89U, 0x93U,
    0x69U, 0x5AU, 0xD1U, 0x60U, 0xDBU, 0x43U, 0x3DU, 0x09U, 0x86U, 0xAAU, 0x05U, 0xAAU, 0xADU, 0x54U, 0x6FU, 0x97U,
    0x86U, 0x94U, 0x60U, 0x1AU, 0xEAU, 0x80U, 0x85U, 0x98U, 0x9EU, 0x9DU, 0x6AU, 0x58U, 0x04U, 0xC5U, 0x66U, 0x49U,
    0x9AU, 0xAEU, 0x74U, 0x93U, 0x23U, 0x23U, 0x4FU, 0x63U, 0xCBU, 0x20U, 0x67U, 0x38U, 0x48U, 0x65U, 0x97U, 0x96U,
    0x1CU, 0x1DU, 0xB0U, 0xA4U, 0x1DU, 0x40U, 0x52U, 0x43U, 0xFAU, 0x08U, 0xFAU, 0x41U, 0xB8U, 0xA6U, 0x90U, 0x8EU,
    0x04U, 0x6EU, 0x1AU, 0x48U, 0x74U, 0x90U, 0xC2U, 0x08U, 0x3BU, 0x5EU, 0x91U, 0x25U, 0xBCU, 0xADU, 0xD4U, 0x54U};

static const uint8_t s_SharedSecretKat521[132U] = {
    0x01U, 0x39U, 0x3AU, 0x0EU, 0xE7U, 0x1EU, 0x70U, 0x66U, 0x14U, 0x5DU, 0xEAU, 0xDEU, 0x9BU, 0x7BU, 0x7DU,
    0x73U, 0x95U, 0xB4U, 0xAAU, 0xDDU, 0x55U, 0x61U, 0x28U, 0xBEU, 0x46U, 0x38U, 0x36U, 0x36U, 0x13U, 0x80U,
    0x99U, 0x2FU, 0x37U, 0x3CU, 0xDDU, 0xD0U, 0x43U, 0x69U, 0xFCU, 0x75U, 0x1EU, 0x7EU, 0x41U, 0x30U, 0x5AU,
    0x11U, 0xC0U, 0x57U, 0x7FU, 0xE7U, 0x98U, 0x58U, 0x27U, 0x31U, 0x6BU, 0x31U, 0xE7U, 0x7DU, 0x18U, 0x6CU,
    0xD1U, 0x31U, 0x19U, 0x6CU, 0xB4U, 0xB0U, 0x01U, 0x39U, 0x9AU, 0x70U, 0xFCU, 0xB1U, 0x9EU, 0x9CU, 0x57U,
    0xB3U, 0x82U, 0x1DU, 0x2BU, 0x8DU, 0x6DU, 0x69U, 0xA3U, 0xEFU, 0x3AU, 0xEDU, 0x05U, 0xC8U, 0x25U, 0xE2U,
    0xE0U, 0xEAU, 0xABU, 0x17U, 0xD7U, 0xA1U, 0xDFU, 0xD7U, 0xA3U, 0xB4U, 0x6AU, 0xC5U, 0x62U, 0xE6U, 0xA1U,
    0x28U, 0xD8U, 0x75U, 0x09U, 0xACU, 0xBFU, 0x77U, 0x82U, 0xD0U, 0x55U, 0x38U, 0x38U, 0x9EU, 0xEDU, 0xAAU,
    0x47U, 0x75U, 0xDBU, 0x81U, 0x5BU, 0x24U, 0xE9U, 0x85U, 0x3FU, 0x17U, 0x06U, 0xE1U};

/*******************************************************************************
 * Code
 ******************************************************************************/
/*!
 * @brief Execute ECDH.
 */
static bool ecdh(uint32_t bit_length)
{
    const uint32_t p_byte_length = (bit_length + 7U) / 8U;
    const uint32_t n_byte_length = (bit_length + 7U) / 8U;

    mcuxClSession_Descriptor_t session_desc;
    mcuxClSession_Handle_t session = &session_desc;

    /* Allocate and initialize session */
    MCUXCLEXAMPLE_ALLOCATE_AND_INITIALIZE_SESSION(session, MCUXCLECC_POINTMULT_WACPU_SIZE,
                                                  MCUXCLECC_POINTMULT_WAPKC_SIZE(p_byte_length, n_byte_length));

    mcuxClEcc_DomainParam_t domain_param;
    switch (bit_length)
    {
        case WEIER256_BIT_LENGTH:
        {
            domain_param =
                (mcuxClEcc_DomainParam_t){.pA   = s_BN_P256_A,
                                          .pB   = s_BN_P256_B,
                                          .pG   = s_BN_P256_G,
                                          .pP   = s_BN_P256_P,
                                          .pN   = s_BN_P256_N,
                                          .misc = mcuxClEcc_DomainParam_misc_Pack(n_byte_length, p_byte_length)};
            break;
        }
        case WEIER384_BIT_LENGTH:
        {
            domain_param =
                (mcuxClEcc_DomainParam_t){.pA   = s_BN_P384_A,
                                          .pB   = s_BN_P384_B,
                                          .pG   = s_BN_P384_G,
                                          .pP   = s_BN_P384_P,
                                          .pN   = s_BN_P384_N,
                                          .misc = mcuxClEcc_DomainParam_misc_Pack(n_byte_length, p_byte_length)};
            break;
        }
        case WEIER521_BIT_LENGTH:
        {
            domain_param =
                (mcuxClEcc_DomainParam_t){.pA   = s_BN_P521_A,
                                          .pB   = s_BN_P521_B,
                                          .pG   = s_BN_P521_G,
                                          .pP   = s_BN_P521_P,
                                          .pN   = s_BN_P521_N,
                                          .misc = mcuxClEcc_DomainParam_misc_Pack(n_byte_length, p_byte_length)};
            break;
        }
    }

    uint8_t p_result_bob[132U] = {0U};
    mcuxClEcc_PointMult_Param_t pointmult_params;
    switch (bit_length)
    {
        case WEIER256_BIT_LENGTH:
        {
            pointmult_params = (mcuxClEcc_PointMult_Param_t){.curveParam = domain_param,
                                                             .pScalar    = s_PrivateKeyInputWeier256Bob,
                                                             .pPoint     = s_PublicKeyInputWeier256Alice,
                                                             .pResult    = p_result_bob,
                                                             .optLen     = 0U};
            break;
        }
        case WEIER384_BIT_LENGTH:
        {
            pointmult_params = (mcuxClEcc_PointMult_Param_t){.curveParam = domain_param,
                                                             .pScalar    = s_PrivateKeyInputWeier384Bob,
                                                             .pPoint     = s_PublicKeyInputWeier384Alice,
                                                             .pResult    = p_result_bob,
                                                             .optLen     = 0U};
            break;
        }
        case WEIER521_BIT_LENGTH:
        {
            pointmult_params = (mcuxClEcc_PointMult_Param_t){.curveParam = domain_param,
                                                             .pScalar    = s_PrivateKeyInputWeier521Bob,
                                                             .pPoint     = s_PublicKeyInputWeier521Alice,
                                                             .pResult    = p_result_bob,
                                                             .optLen     = 0U};
            break;
        }
    }

    MCUX_CSSL_FP_FUNCTION_CALL_BEGIN(result, token, mcuxClEcc_PointMult(session, &pointmult_params));
    if (MCUX_CSSL_FP_FUNCTION_CALLED(mcuxClEcc_PointMult) != token)
    {
        return MCUXCLEXAMPLE_STATUS_ERROR;
    }
    if (MCUXCLECC_STATUS_INVALID_PARAMS == result)
    {
        return MCUXCLEXAMPLE_STATUS_ERROR;
    }
    else if (MCUXCLECC_STATUS_OK != result)
    {
        return MCUXCLEXAMPLE_STATUS_ERROR;
    }
    MCUX_CSSL_FP_FUNCTION_CALL_END();

    mcuxClEcc_PointMult_Param_t point_mult_params_bob_key;
    switch (bit_length)
    {
        case WEIER256_BIT_LENGTH:
        {
            point_mult_params_bob_key = (mcuxClEcc_PointMult_Param_t){.curveParam = domain_param,
                                                                      .pScalar    = s_PrivateKeyInputWeier256Bob,
                                                                      .pPoint     = s_AlicePointMult256,
                                                                      .pResult    = p_result_bob,
                                                                      .optLen     = 0U};
            break;
        }
        case WEIER384_BIT_LENGTH:
        {
            point_mult_params_bob_key = (mcuxClEcc_PointMult_Param_t){.curveParam = domain_param,
                                                                      .pScalar    = s_PrivateKeyInputWeier384Bob,
                                                                      .pPoint     = s_AlicePointMult384,
                                                                      .pResult    = p_result_bob,
                                                                      .optLen     = 0U};
            break;
        }
        case WEIER521_BIT_LENGTH:
        {
            point_mult_params_bob_key = (mcuxClEcc_PointMult_Param_t){.curveParam = domain_param,
                                                                      .pScalar    = s_PrivateKeyInputWeier521Bob,
                                                                      .pPoint     = s_AlicePointMult521,
                                                                      .pResult    = p_result_bob,
                                                                      .optLen     = 0U};
            break;
        }
    }

    MCUX_CSSL_FP_FUNCTION_CALL_BEGIN(result, token, mcuxClEcc_PointMult(session, &point_mult_params_bob_key));
    if (MCUX_CSSL_FP_FUNCTION_CALLED(mcuxClEcc_PointMult) != token)
    {
        return MCUXCLEXAMPLE_STATUS_ERROR;
    }
    if (MCUXCLECC_STATUS_INVALID_PARAMS == result)
    {
        return MCUXCLEXAMPLE_STATUS_ERROR;
    }
    else if (MCUXCLECC_STATUS_OK != result)
    {
        return MCUXCLEXAMPLE_STATUS_ERROR;
    }
    MCUX_CSSL_FP_FUNCTION_CALL_END();

    switch (bit_length)
    {
        case WEIER256_BIT_LENGTH:
        {
            if (!mcuxClCore_assertEqual(point_mult_params_bob_key.pResult, s_SharedSecretKat256,
                                        sizeof(s_SharedSecretKat256)))
            {
                return MCUXCLEXAMPLE_STATUS_ERROR;
            }
            break;
        }
        case WEIER384_BIT_LENGTH:
        {
            if (!mcuxClCore_assertEqual(point_mult_params_bob_key.pResult, s_SharedSecretKat384,
                                        sizeof(s_SharedSecretKat384)))
            {
                return MCUXCLEXAMPLE_STATUS_ERROR;
            }
            break;
        }
        case WEIER521_BIT_LENGTH:
        {
            if (!mcuxClCore_assertEqual(point_mult_params_bob_key.pResult, s_SharedSecretKat521,
                                        sizeof(s_SharedSecretKat521)))
            {
                return MCUXCLEXAMPLE_STATUS_ERROR;
            }
            break;
        }
    }

    /**************************************************************************/
    /* Clean session                                                          */
    /**************************************************************************/
    if (!mcuxClExample_Session_Clean(session))
    {
        return MCUXCLEXAMPLE_STATUS_ERROR;
    }
    return MCUXCLEXAMPLE_STATUS_OK;
}

void execute_ecdh_kat(uint64_t options, char name[])
{
    if ((options & FIPS_ECDH256P) || (options & FIPS_ALL_TESTS))
    {
        if (!ecdh(WEIER256_BIT_LENGTH))
        {
            PRINTF("[ERROR] %s KAT FAILED\r\n", name);
        }
    }
    if ((options & FIPS_ECDH384P) || (options & FIPS_ALL_TESTS))
    {
        if (!ecdh(WEIER384_BIT_LENGTH))
        {
            PRINTF("[ERROR] %s KAT FAILED\r\n", name);
        }
    }
    if ((options & FIPS_ECDH521P) || (options & FIPS_ALL_TESTS))
    {
        if (!ecdh(WEIER521_BIT_LENGTH))
        {
            PRINTF("[ERROR] %s KAT FAILED\r\n", name);
        }
    }
}
